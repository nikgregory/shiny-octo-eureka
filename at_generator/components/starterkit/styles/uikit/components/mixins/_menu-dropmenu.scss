// Drop menus
// Standard CSS drop menus that will expand any nesting level.

@mixin dropmenu($dropmenu-item-width: 12em, $dropmenu-arrows: true) {

  .ms-dropmenu {

    .rm-toggle {
      @include visually-hidden;
    }

    .rm-block__content {

      .menu__item {
        text-align: center;
        position: relative;
      }

      a {
        position: relative;
        @include output-rhythm(padding, $xx-small $large);

        @if $dropmenu-arrows == true {
          &:after {
            font-family: $icon-font;
            padding: 0 1px;
            text-align: $flow-to;
            position: absolute;
            @include output-rhythm($flow-to, $medium);
          }
        }
      }

      .menu-level-1 {
        position: relative;

        .menu__item {
          float: $flow-from;
          width: auto;

          a:after {
            content: '';
            display: none;
          }

          @if $dropmenu-arrows == true {
            .fa-loaded & {
              &--collapsed > span > a,
              &--expanded > span > a {
                @include output-rhythm(padding-#{$flow-to}, $medium * 2.5);

                &:after {
                  display: inline-block;
                }
              }

              &--expanded > span > a:after {
                content: $menu-arrow-down;
              }

              &--collapsed > span > a:after {
                content: '';
              }
            }
          }

          &:hover,
          &:focus {
            > .is-child {
              visibility: visible;
              opacity: 1;
            }
          }
        }
      }

      .is-child {
        position: absolute;
        visibility: hidden;
        opacity: 0;
        margin: 0;
        padding: 0;
        max-height: 1000px;

        &:hover,
        &:focus {
          visibility: visible;
          opacity: 1;
        }

        .menu__item {
          min-width: $dropmenu-item-width;
          text-align: $flow-from;
        }
      }

      // Allow for momentary mouse out.
      .menu {
        transition: 0.15s 0.5s;

        &:hover .menu {
          transition-delay: 0s;
        }
      }

      // Down
      .is-child {
        #{$flow-from}: 0; // LTR
        top: auto;

        @if $dropmenu-arrows == true {
          .fa-loaded & {
            > .menu__item--expanded > a:after {
              content: $menu-arrow-right;

              [dir="rtl"] & {
                content: $menu-arrow-left;
              }
            }
          }
        }
      }

      // Across
      .is-child.odd {
        #{$flow-from}: 100%; // LTR
        top: 0;

        @if $dropmenu-arrows == true {
          .fa-loaded & {
            > .menu__item--expanded > a:after {
              content: $menu-arrow-down;
            }
          }
        }
      }
    }
  }
}

